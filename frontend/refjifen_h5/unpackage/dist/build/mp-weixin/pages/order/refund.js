(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/refund"],{"39be":function(e,t,n){"use strict";n.r(t);var r=n("b4d0"),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=a.a},"529d":function(e,t,n){"use strict";n.r(t);var r=n("f32e"),a=n("39be");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("bd14");var i=n("828b"),u=Object(i["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],void 0);t["default"]=u.exports},"81ce":function(e,t,n){"use strict";(function(e,t){var r=n("47a9");n("a82b");r(n("3240"));var a=r(n("529d"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},b4d0:function(e,t,n){"use strict";(function(e){var r=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("7eb4")),o=r(n("ee10"));function i(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c={data:function(){return{order_sn:"",type:"1",reason:"",images:[]}},onLoad:function(t){t.order_sn?this.order_sn=t.order_sn:(e.showToast({title:"参数错误",icon:"none"}),setTimeout((function(){return e.navigateBack()}),1500))},methods:{onTypeChange:function(e){this.type=e.detail.value},chooseImage:function(){var t=this;e.chooseImage({count:3-this.images.length,success:function(e){t.uploadImages(e.tempFilePaths)}})},uploadImages:function(t){var n=this;return(0,o.default)(a.default.mark((function r(){var o,u,c,s;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(o=e.getStorageSync("token"),o){r.next=3;break}return r.abrupt("return",e.showToast({title:"请先登录",icon:"none"}));case 3:e.showLoading({title:"上传中"}),u=i(t),r.prev=5,s=a.default.mark((function t(){var r,i,u;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.value,t.prev=1,t.next=4,new Promise((function(t,n){e.uploadFile({url:"https://ref.tajian.cc/backend/api/upload.php",filePath:r,name:"file",header:{Authorization:"Bearer "+o},success:t,fail:n})}));case 4:i=t.sent,u=JSON.parse(i.data),200==u.code?n.images.push(u.url):e.showToast({title:u.message||"上传失败",icon:"none"}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),e.showToast({title:"上传出错",icon:"none"});case 12:case"end":return t.stop()}}),t,null,[[1,9]])})),u.s();case 8:if((c=u.n()).done){r.next=12;break}return r.delegateYield(s(),"t0",10);case 10:r.next=8;break;case 12:r.next=17;break;case 14:r.prev=14,r.t1=r["catch"](5),u.e(r.t1);case 17:return r.prev=17,u.f(),r.finish(17);case 20:e.hideLoading();case 21:case"end":return r.stop()}}),r,null,[[5,14,17,20]])})))()},delImage:function(e){this.images.splice(e,1)},previewImage:function(t){e.previewImage({urls:[t]})},submit:function(){var t=this;return(0,o.default)(a.default.mark((function n(){var r,o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.reason){n.next=2;break}return n.abrupt("return",e.showToast({title:"请填写原因",icon:"none"}));case 2:return e.showLoading({title:"提交中"}),n.prev=3,r={order_sn:t.order_sn,type:t.type,reason:t.reason,images:t.images.join(",")},n.next=7,e.$api("mall.php?action=apply_refund","POST",r);case 7:o=n.sent,e.hideLoading(),200==o.code?(e.showToast({title:"提交成功"}),setTimeout((function(){e.navigateBack()}),1500)):e.showToast({title:o.message||"提交失败",icon:"none"}),n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](3),e.hideLoading(),e.showToast({title:"网络错误",icon:"none"});case 16:case"end":return n.stop()}}),n,null,[[3,12]])})))()}}};t.default=c}).call(this,n("df3c")["default"])},bd14:function(e,t,n){"use strict";var r=n("c74c"),a=n.n(r);a.a},c74c:function(e,t,n){},f32e:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var r=function(){var e=this.$createElement,t=(this._self._c,this.images.length);this.$mp.data=Object.assign({},{$root:{g0:t}})},a=[]}},[["81ce","common/runtime","common/vendor"]]]);