(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/profile"],{"0b69":function(e,t,n){"use strict";var a=n("486b"),o=n.n(a);o.a},"358f":function(e,t,n){"use strict";(function(e){var a=n("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("7eb4")),i=a(n("ee10")),c={data:function(){return{user:{nickname:"",mobile:"",avatar:""}}},onLoad:function(){this.fetchInfo()},methods:{fetchInfo:function(){var t=this;return(0,i.default)(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$api("account.php?action=info");case 3:a=n.sent,200==a.code&&(t.user=a.data),n.next=9;break;case 7:n.prev=7,n.t0=n["catch"](0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()},changeAvatar:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed"],success:function(n){var a=n.tempFilePaths,o=e.getStorageSync("token");e.showLoading({title:"上传中..."}),e.uploadFile({url:"https://ref.tajian.cc/backend/api/upload.php",filePath:a[0],name:"file",header:{Authorization:"Bearer "+o},success:function(n){e.hideLoading();try{var a=JSON.parse(n.data);200==a.code?(t.user.avatar=a.url,e.showToast({title:"上传/预览成功",icon:"none"})):e.showToast({title:a.message||"上传失败",icon:"none"})}catch(o){e.showToast({title:"解析失败",icon:"none"})}},fail:function(t){e.hideLoading(),e.showToast({title:"网络错误",icon:"none"})}})}})},save:function(){var t=this;return(0,i.default)(o.default.mark((function n(){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.showLoading({title:"保存中"}),n.prev=1,n.next=4,e.$api("account.php?action=update_profile","POST",{nickname:t.user.nickname,mobile:t.user.mobile,avatar:t.user.avatar});case 4:a=n.sent,e.hideLoading(),200==a.code?(e.showToast({title:"保存成功"}),setTimeout((function(){return e.navigateBack()}),1500)):e.showToast({title:a.message,icon:"none"}),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](1),e.hideLoading();case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))()}}};t.default=c}).call(this,n("df3c")["default"])},"486b":function(e,t,n){},5792:function(e,t,n){"use strict";n.r(t);var a=n("358f"),o=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=o.a},e344:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement;this._self._c},o=[]},e446:function(e,t,n){"use strict";(function(e,t){var a=n("47a9");n("a82b");a(n("3240"));var o=a(n("fd20"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])},fd20:function(e,t,n){"use strict";n.r(t);var a=n("e344"),o=n("5792");for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);n("0b69");var c=n("828b"),r=Object(c["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);t["default"]=r.exports}},[["e446","common/runtime","common/vendor"]]]);