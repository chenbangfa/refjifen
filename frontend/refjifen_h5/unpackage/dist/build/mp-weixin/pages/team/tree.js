(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/team/tree"],{"24ca":function(e,n,t){"use strict";(function(e){var a=t("47a9");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=a(t("7eb4")),o=a(t("ee10")),i={components:{tabBar:function(){t.e("components/tab-bar/tab-bar").then(function(){return resolve(t("a372"))}.bind(null,t)).catch(t.oe)},treeChart:function(){t.e("components/tree-chart/tree-chart").then(function(){return resolve(t("97b1"))}.bind(null,t)).catch(t.oe)}},data:function(){return{team:{},myUserId:0,pendingList:[],showPendingModal:!1,showPlaceForm:!1,currentPending:{},placeForm:{parentId:"",position:"L"}}},onShow:function(){var n=e.getStorageSync("user");n&&(this.myUserId=n.id),this.loadTeam(this.myUserId),this.loadPending()},methods:{loadTeam:function(n){var t=this;return(0,o.default)(r.default.mark((function a(){var o;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n){a.next=2;break}return a.abrupt("return");case 2:return e.showLoading({title:"加载中"}),a.prev=3,a.next=6,e.$api("account.php?action=team&id=".concat(n));case 6:o=a.sent,e.hideLoading(),200==o.code?t.team=o.data:e.showToast({title:o.message,icon:"none"}),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](3),e.hideLoading();case 14:case"end":return a.stop()}}),a,null,[[3,11]])})))()},onNodeClick:function(e){e&&e.id&&this.loadTeam(e.id)},drillDown:function(e){this.loadTeam(e)},loadPending:function(){var n=this;return(0,o.default)(r.default.mark((function t(){var a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$api("team.php?action=pending_list");case 3:a=t.sent,200==a.code&&(n.pendingList=a.data),t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})))()},openPlaceForm:function(e){this.currentPending=e,this.placeForm.parentId="",this.placeForm.position="L",this.showPlaceForm=!0,this.showPendingModal=!1},submitPlacement:function(){var n=this;return(0,o.default)(r.default.mark((function t(){var a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.placeForm.parentId){t.next=2;break}return t.abrupt("return",e.showToast({title:"请输入上级ID",icon:"none"}));case 2:return e.showLoading({title:"处理中"}),t.prev=3,t.next=6,e.$api("team.php?action=place_user","POST",{target_user_id:n.currentPending.id,parent_id:n.placeForm.parentId,position:n.placeForm.position});case 6:a=t.sent,e.hideLoading(),200==a.code?(e.showToast({title:"安置成功",icon:"success"}),n.showPlaceForm=!1,n.loadPending(),n.loadTeam(n.team.id)):e.showToast({title:a.message,icon:"none"}),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](3),e.hideLoading(),e.showToast({title:"请求失败",icon:"none"});case 15:case"end":return t.stop()}}),t,null,[[3,11]])})))()}}};n.default=i}).call(this,t("df3c")["default"])},"414b":function(e,n,t){"use strict";t.r(n);var a=t("cfa2"),r=t("6584");for(var o in r)["default"].indexOf(o)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(o);t("c434");var i=t("828b"),c=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);n["default"]=c.exports},6584:function(e,n,t){"use strict";t.r(n);var a=t("24ca"),r=t.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){t.d(n,e,(function(){return a[e]}))}(o);n["default"]=r.a},"7e54":function(e,n,t){},"85fd":function(e,n,t){"use strict";(function(e,n){var a=t("47a9");t("a82b");a(t("3240"));var r=a(t("414b"));e.__webpack_require_UNI_MP_PLUGIN__=t,n(r.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},c434:function(e,n,t){"use strict";var a=t("7e54"),r=t.n(a);r.a},cfa2:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){return a}));var a={treeChart:function(){return t.e("components/tree-chart/tree-chart").then(t.bind(null,"97b1"))},tabBar:function(){return t.e("components/tab-bar/tab-bar").then(t.bind(null,"a372"))}},r=function(){var e=this,n=e.$createElement,t=(e._self._c,e.pendingList.length),a=t>0?e.pendingList.length:null,r=e.showPendingModal?e.__map(e.pendingList,(function(n,t){var a=e.__get_orig(n),r=n.created_at.substring(0,10);return{$orig:a,g2:r}})):null;e._isMounted||(e.e0=function(n){e.showPendingModal=!0},e.e1=function(n){if(n.target!==n.currentTarget)return null;e.showPendingModal=!1},e.e2=function(n){e.showPendingModal=!1},e.e3=function(n){if(n.target!==n.currentTarget)return null;e.showPlaceForm=!1},e.e4=function(n){e.placeForm.position=n.detail.value},e.e5=function(n){e.showPlaceForm=!1}),e.$mp.data=Object.assign({},{$root:{g0:t,g1:a,l0:r}})},o=[]}},[["85fd","common/runtime","common/vendor"]]]);