(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-my-accounts"],{"142c":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"container"},[a("v-uni-view",{staticClass:"account-list"},t._l(t.accounts,(function(e,n){return a("v-uni-view",{key:n,staticClass:"account-item",class:{active:e.is_current},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.switchAcc(e)}}},[a("v-uni-view",{staticClass:"acc-left"},[a("v-uni-image",{staticClass:"acc-avatar",attrs:{src:"/static/my.png"}}),a("v-uni-view",{staticClass:"acc-info"},[a("v-uni-view",{staticClass:"acc-name"},[t._v(" "+t._s(e.nickname||"未命名")+" "),1==e.is_sub_account?a("v-uni-text",{staticClass:"tag"},[t._v("子")]):a("v-uni-text",{staticClass:"tag master"},[t._v("主")])],1),a("v-uni-view",{staticClass:"acc-detail"},[t._v("ID: "+t._s(e.id)+" | 手机: "+t._s(t.maskMobile(e.mobile)))]),e.invite_code?a("v-uni-view",{staticClass:"acc-detail"},[t._v("邀请码: "+t._s(e.invite_code))]):t._e()],1)],1),a("v-uni-view",{staticClass:"acc-right"},[e.is_current?a("v-uni-view",{staticClass:"current-badge"},[t._v("当前使用")]):a("v-uni-view",{staticClass:"switch-btn"},[t._v("切换")])],1)],1)})),1),a("v-uni-view",{staticClass:"footer-action"},[a("v-uni-view",{staticClass:"add-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addAccount.apply(void 0,arguments)}}},[t._v("+ 添加/激活新账号")])],1)],1)},i=[]},"27d7":function(t,e,a){"use strict";a.r(e);var n=a("33d6"),i=a.n(n);for(var c in n)["default"].indexOf(c)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(c);e["default"]=i.a},"33d6":function(t,e,a){"use strict";a("6a54");var n=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("2634")),c=n(a("2fdc")),o={data:function(){return{accounts:[],redirect:""}},onLoad:function(t){this.redirect=t.redirect||""},onShow:function(){this.loadAccounts()},methods:{loadAccounts:function(){var t=this;return(0,c.default)((0,i.default)().mark((function e(){var a;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return uni.showLoading({title:"加载中"}),e.prev=1,e.next=4,uni.$api("auth.php?action=list_accounts");case 4:a=e.sent,uni.hideLoading(),200==a.code&&(t.accounts=a.data),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),uni.hideLoading();case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},maskMobile:function(t){return t?t.substr(0,3)+"****"+t.substr(7):""},switchAcc:function(t){var e=this;return(0,c.default)((0,i.default)().mark((function a(){var n;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t.is_current){a.next=2;break}return a.abrupt("return");case 2:return uni.showLoading({title:"切换中..."}),a.prev=3,a.next=6,uni.$api("auth.php?action=quick_login","POST",{target_id:t.id});case 6:n=a.sent,uni.hideLoading(),200==n.code?(uni.setStorageSync("token",n.token),uni.showToast({title:"切换成功",icon:"success"}),setTimeout((function(){var t=e.redirect?decodeURIComponent(e.redirect):"/pages/my/my";uni.reLaunch({url:t})}),1e3)):uni.showToast({title:n.message,icon:"none"}),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](3),uni.hideLoading();case 14:case"end":return a.stop()}}),a,null,[[3,11]])})))()},addAccount:function(){var t=this;uni.showActionSheet({itemList:["激活子账号","注册新账号"],success:function(e){0==e.tapIndex?t.triggerActivate():uni.navigateTo({url:"/pages/login/register"})}})},triggerActivate:function(){var t=this;uni.showModal({title:"激活子账号",editable:!0,placeholderText:"设置子账号密码",success:function(){var e=(0,c.default)((0,i.default)().mark((function e(a){return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.confirm&&a.content&&t.doActivate(a.content);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})},doActivate:function(t){var e=this;return(0,c.default)((0,i.default)().mark((function a(){var n,c,o;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return uni.showLoading({title:"激活中"}),a.prev=1,a.next=4,uni.$api("account.php?action=info");case 4:if(n=a.sent,200==n.code){a.next=7;break}return a.abrupt("return");case 7:return c=n.data.mobile,a.next=10,uni.$api("account.php?action=activate_sub","POST",{sub_mobile:c,password:t,position:"L"});case 10:o=a.sent,uni.hideLoading(),200==o.code?(uni.showToast({title:"激活成功",icon:"success"}),e.loadAccounts()):uni.showToast({title:o.message,icon:"none"}),a.next=18;break;case 15:a.prev=15,a.t0=a["catch"](1),uni.hideLoading();case 18:case"end":return a.stop()}}),a,null,[[1,15]])})))()}}};e.default=o},"7e76":function(t,e,a){"use strict";a.r(e);var n=a("142c"),i=a("27d7");for(var c in i)["default"].indexOf(c)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(c);a("c8cd");var o=a("828b"),r=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"25769e47",null,!1,n["a"],void 0);e["default"]=r.exports},"975a":function(t,e,a){var n=a("c86c");e=n(!1),e.push([t.i,".container[data-v-25769e47]{padding-bottom:80px}.account-list[data-v-25769e47]{padding:15px}.account-item[data-v-25769e47]{background:#fff;padding:15px;border-radius:12px;margin-bottom:15px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 8px rgba(0,0,0,.05);border:1px solid transparent}.account-item.active[data-v-25769e47]{border-color:#07c160;background:#e8f5eb}.acc-left[data-v-25769e47]{display:flex;align-items:center}.acc-avatar[data-v-25769e47]{width:50px;height:50px;border-radius:25px;background:#eee;margin-right:15px}.acc-name[data-v-25769e47]{font-size:16px;font-weight:700;color:#333;margin-bottom:5px}.tag[data-v-25769e47]{font-size:10px;padding:1px 4px;border-radius:4px;margin-left:5px;background:#ff9800;color:#fff}.tag.master[data-v-25769e47]{background:#07c160}.acc-detail[data-v-25769e47]{font-size:12px;color:#999}.acc-right[data-v-25769e47]{text-align:right}.current-badge[data-v-25769e47]{font-size:12px;color:#07c160;font-weight:700}.switch-btn[data-v-25769e47]{padding:5px 12px;background:#fff;border:1px solid #ddd;border-radius:15px;font-size:12px;color:#666}.footer-action[data-v-25769e47]{position:fixed;bottom:0;left:0;width:100%;padding:15px;background:#fff;box-shadow:0 -2px 10px rgba(0,0,0,.05);box-sizing:border-box}.add-btn[data-v-25769e47]{background:#07c160;color:#fff;text-align:center;padding:12px;border-radius:8px;font-size:16px;font-weight:700}",""]),t.exports=e},c8cd:function(t,e,a){"use strict";var n=a("d168"),i=a.n(n);i.a},d168:function(t,e,a){var n=a("975a");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("967d").default;i("f6835704",n,!0,{sourceMap:!1,shadowMode:!1})}}]);