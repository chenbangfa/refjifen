(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-my-profile"],{"42c5":function(t,e,a){var n=a("c547");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("967d").default;i("559f92a6",n,!0,{sourceMap:!1,shadowMode:!1})},4326:function(t,e,a){"use strict";a("6a54");var n=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("2634")),c=n(a("2fdc")),o={data:function(){return{user:{nickname:"",mobile:"",avatar:""}}},onLoad:function(){this.fetchInfo()},methods:{fetchInfo:function(){var t=this;return(0,c.default)((0,i.default)().mark((function e(){var a;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,uni.$api("account.php?action=info");case 3:a=e.sent,200==a.code&&(t.user=a.data),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))()},changeAvatar:function(){var t=this;uni.chooseImage({count:1,sizeType:["compressed"],success:function(e){var a=e.tempFilePaths,n=uni.getStorageSync("token");uni.showLoading({title:"上传中..."}),uni.uploadFile({url:"https://ref.tajian.cc/backend/api/upload.php",filePath:a[0],name:"file",header:{Authorization:"Bearer "+n},success:function(e){uni.hideLoading();try{var a=JSON.parse(e.data);200==a.code?(t.user.avatar=a.url,uni.showToast({title:"上传/预览成功",icon:"none"})):uni.showToast({title:a.message||"上传失败",icon:"none"})}catch(n){uni.showToast({title:"解析失败",icon:"none"})}},fail:function(t){uni.hideLoading(),uni.showToast({title:"网络错误",icon:"none"})}})}})},save:function(){var t=this;return(0,c.default)((0,i.default)().mark((function e(){var a;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return uni.showLoading({title:"保存中"}),e.prev=1,e.next=4,uni.$api("account.php?action=update_profile","POST",{nickname:t.user.nickname,mobile:t.user.mobile,avatar:t.user.avatar});case 4:a=e.sent,uni.hideLoading(),200==a.code?(uni.showToast({title:"保存成功"}),setTimeout((function(){return uni.navigateBack()}),1500)):uni.showToast({title:a.message,icon:"none"}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),uni.hideLoading();case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()}}};e.default=o},5792:function(t,e,a){"use strict";a.r(e);var n=a("4326"),i=a.n(n);for(var c in n)["default"].indexOf(c)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(c);e["default"]=i.a},"98ce":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"container"},[a("v-uni-view",{staticClass:"form-group"},[a("v-uni-view",{staticClass:"form-item avatar-row",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeAvatar.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"label"},[t._v("头像")]),a("v-uni-view",{staticClass:"right"},[a("v-uni-image",{staticClass:"avatar",attrs:{src:t.user.avatar||"/static/my.png"}}),a("v-uni-text",{staticClass:"iconfont icon-right arrow"})],1)],1),a("v-uni-view",{staticClass:"form-item"},[a("v-uni-text",{staticClass:"label"},[t._v("姓名")]),a("v-uni-input",{staticClass:"input",attrs:{placeholder:"请输入姓名"},model:{value:t.user.nickname,callback:function(e){t.$set(t.user,"nickname",e)},expression:"user.nickname"}})],1),a("v-uni-view",{staticClass:"form-item"},[a("v-uni-text",{staticClass:"label"},[t._v("手机号")]),a("v-uni-input",{staticClass:"input",attrs:{placeholder:"请输入手机号",type:"number"},model:{value:t.user.mobile,callback:function(e){t.$set(t.user,"mobile",e)},expression:"user.mobile"}})],1)],1),a("v-uni-view",{staticClass:"btn-area"},[a("v-uni-button",{staticClass:"save-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.save.apply(void 0,arguments)}}},[t._v("保存修改")])],1)],1)},i=[]},c547:function(t,e,a){var n=a("c86c");e=n(!1),e.push([t.i,".container[data-v-7b46fc10]{padding:15px;min-height:100vh;background:linear-gradient(135deg,#b2ebf2,#bbdefb)}.form-group[data-v-7b46fc10]{background:#fff;border-radius:12px;padding:0 15px;margin-bottom:20px}.form-item[data-v-7b46fc10]{display:flex;justify-content:space-between;align-items:center;padding:15px 0;border-bottom:1px solid #f5f5f5;height:50px}.form-item[data-v-7b46fc10]:last-child{border-bottom:none}.label[data-v-7b46fc10]{font-size:16px;color:#333}.input[data-v-7b46fc10]{text-align:right;font-size:16px;color:#333}.right[data-v-7b46fc10]{display:flex;align-items:center}.avatar[data-v-7b46fc10]{width:40px;height:40px;border-radius:20px;margin-right:10px;background:#eee}.arrow[data-v-7b46fc10]{color:#ccc;font-size:14px}.btn-area[data-v-7b46fc10]{margin-top:30px}.save-btn[data-v-7b46fc10]{background:#07c160;color:#fff;border-radius:25px;height:44px;line-height:44px;font-size:16px}.save-btn[data-v-7b46fc10]:active{opacity:.9}",""]),t.exports=e},c9f2:function(t,e,a){"use strict";var n=a("42c5"),i=a.n(n);i.a},fd20:function(t,e,a){"use strict";a.r(e);var n=a("98ce"),i=a("5792");for(var c in i)["default"].indexOf(c)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(c);a("c9f2");var o=a("828b"),r=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"7b46fc10",null,!1,n["a"],void 0);e["default"]=r.exports}}]);