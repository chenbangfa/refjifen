(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-my-accounts"],{"1a91":function(t,a,e){"use strict";var n=e("97d9"),i=e.n(n);i.a},"27d7":function(t,a,e){"use strict";e.r(a);var n=e("33d6"),i=e.n(n);for(var c in n)["default"].indexOf(c)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(c);a["default"]=i.a},"33d6":function(t,a,e){"use strict";e("6a54");var n=e("f5bd").default;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=n(e("2634")),c=n(e("2fdc")),o={data:function(){return{accounts:[],redirect:""}},onLoad:function(t){this.redirect=t.redirect||""},onShow:function(){this.loadAccounts()},methods:{loadAccounts:function(){var t=this;return(0,c.default)((0,i.default)().mark((function a(){var e;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return uni.showLoading({title:"加载中"}),a.prev=1,a.next=4,uni.$api("auth.php?action=list_accounts");case 4:e=a.sent,uni.hideLoading(),200==e.code&&(t.accounts=e.data),a.next=12;break;case 9:a.prev=9,a.t0=a["catch"](1),uni.hideLoading();case 12:case"end":return a.stop()}}),a,null,[[1,9]])})))()},maskMobile:function(t){return t?t.substr(0,3)+"****"+t.substr(7):""},switchAcc:function(t){var a=this;return(0,c.default)((0,i.default)().mark((function e(){var n;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.is_current){e.next=2;break}return e.abrupt("return");case 2:return uni.showLoading({title:"切换中..."}),e.prev=3,e.next=6,uni.$api("auth.php?action=quick_login","POST",{target_id:t.id});case 6:n=e.sent,uni.hideLoading(),200==n.code?(uni.setStorageSync("token",n.token),uni.showToast({title:"切换成功",icon:"success"}),setTimeout((function(){var t=a.redirect?decodeURIComponent(a.redirect):"/pages/my/my";uni.reLaunch({url:t})}),1e3)):uni.showToast({title:n.message,icon:"none"}),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](3),uni.hideLoading();case 14:case"end":return e.stop()}}),e,null,[[3,11]])})))()},addAccount:function(){var t=this;uni.showActionSheet({itemList:["激活子账号","注册新账号"],success:function(a){0==a.tapIndex?t.triggerActivate():uni.navigateTo({url:"/pages/login/register"})}})},triggerActivate:function(){var t=this;uni.showModal({title:"激活子账号",editable:!0,placeholderText:"设置子账号密码",success:function(){var a=(0,c.default)((0,i.default)().mark((function a(e){return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.confirm&&e.content&&t.doActivate(e.content);case 1:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()})},doActivate:function(t){var a=this;return(0,c.default)((0,i.default)().mark((function e(){var n,c,o;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return uni.showLoading({title:"激活中"}),e.prev=1,e.next=4,uni.$api("account.php?action=info");case 4:if(n=e.sent,200==n.code){e.next=7;break}return e.abrupt("return");case 7:return c=n.data.mobile,e.next=10,uni.$api("account.php?action=activate_sub","POST",{sub_mobile:c,password:t,position:"L"});case 10:o=e.sent,uni.hideLoading(),200==o.code?(uni.showToast({title:"激活成功",icon:"success"}),a.loadAccounts()):uni.showToast({title:o.message,icon:"none"}),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](1),uni.hideLoading();case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))()}}};a.default=o},"3acb":function(t,a,e){var n=e("c86c");a=n(!1),a.push([t.i,".container[data-v-04e6da4a]{padding-bottom:80px}.account-list[data-v-04e6da4a]{padding:15px}.account-item[data-v-04e6da4a]{background:#fff;padding:15px;border-radius:12px;margin-bottom:15px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 8px rgba(0,0,0,.05);border:1px solid transparent}.account-item.active[data-v-04e6da4a]{border-color:#07c160;background:#e8f5eb}.acc-left[data-v-04e6da4a]{display:flex;align-items:center}.acc-avatar[data-v-04e6da4a]{width:50px;height:50px;border-radius:25px;background:#eee;margin-right:15px}.acc-name[data-v-04e6da4a]{font-size:16px;font-weight:700;color:#333;margin-bottom:5px}.tag[data-v-04e6da4a]{font-size:10px;padding:1px 4px;border-radius:4px;margin-left:5px;background:#ff9800;color:#fff}.tag.master[data-v-04e6da4a]{background:#07c160}.acc-detail[data-v-04e6da4a]{font-size:12px;color:#999}.acc-right[data-v-04e6da4a]{text-align:right}.current-badge[data-v-04e6da4a]{font-size:12px;color:#07c160;font-weight:700}.switch-btn[data-v-04e6da4a]{padding:5px 12px;background:#fff;border:1px solid #ddd;border-radius:15px;font-size:12px;color:#666}.footer-action[data-v-04e6da4a]{position:fixed;bottom:0;left:0;width:100%;padding:15px;background:#fff;box-shadow:0 -2px 10px rgba(0,0,0,.05);box-sizing:border-box}.add-btn[data-v-04e6da4a]{background:#07c160;color:#fff;text-align:center;padding:12px;border-radius:8px;font-size:16px;font-weight:700}",""]),t.exports=a},"66da":function(t,a,e){"use strict";e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return i})),e.d(a,"a",(function(){}));var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{staticClass:"container"},[e("v-uni-view",{staticClass:"account-list"},t._l(t.accounts,(function(a,n){return e("v-uni-view",{key:n,staticClass:"account-item",class:{active:a.is_current},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.switchAcc(a)}}},[e("v-uni-view",{staticClass:"acc-left"},[e("v-uni-image",{staticClass:"acc-avatar",attrs:{src:"/static/my.png"}}),e("v-uni-view",{staticClass:"acc-info"},[e("v-uni-view",{staticClass:"acc-name"},[t._v(" "+t._s(a.nickname||"未命名")+" "),1==a.is_sub_account?e("v-uni-text",{staticClass:"tag"},[t._v("子")]):e("v-uni-text",{staticClass:"tag master"},[t._v("主")])],1),a.invite_code?e("v-uni-view",{staticClass:"acc-detail"},[t._v("UID: "+t._s(a.invite_code))]):t._e(),e("v-uni-view",{staticClass:"acc-detail"},[t._v("手机: "+t._s(t.maskMobile(a.mobile)))])],1)],1),e("v-uni-view",{staticClass:"acc-right"},[a.is_current?e("v-uni-view",{staticClass:"current-badge"},[t._v("当前使用")]):e("v-uni-view",{staticClass:"switch-btn"},[t._v("切换")])],1)],1)})),1),e("v-uni-view",{staticClass:"footer-action"},[e("v-uni-view",{staticClass:"add-btn",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.addAccount.apply(void 0,arguments)}}},[t._v("+ 添加/激活新账号")])],1)],1)},i=[]},"7e76":function(t,a,e){"use strict";e.r(a);var n=e("66da"),i=e("27d7");for(var c in i)["default"].indexOf(c)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(c);e("1a91");var o=e("828b"),r=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,"04e6da4a",null,!1,n["a"],void 0);a["default"]=r.exports},"97d9":function(t,a,e){var n=e("3acb");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=e("967d").default;i("2536ab10",n,!0,{sourceMap:!1,shadowMode:!1})}}]);