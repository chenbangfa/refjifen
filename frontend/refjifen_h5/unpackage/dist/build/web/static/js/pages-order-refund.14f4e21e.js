(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-refund"],{"1c27":function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,".container[data-v-77627575]{padding:15px;background:#f5f5f5;min-height:100vh}.form-group[data-v-77627575]{background:#fff;border-radius:8px;padding:0 15px;margin-bottom:15px}.form-item[data-v-77627575]{display:flex;align-items:center;border-bottom:1px solid #f9f9f9;padding:15px 0}.form-item[data-v-77627575]:last-child{border-bottom:none}.label[data-v-77627575]{width:80px;font-size:14px;color:#333}.value[data-v-77627575]{font-size:14px;color:#666}.input[data-v-77627575]{flex:1;font-size:14px}.radio-group[data-v-77627575]{display:flex}.radio[data-v-77627575]{margin-right:20px;font-size:14px;display:flex;align-items:center}.upload-group[data-v-77627575]{background:#fff;border-radius:8px;padding:15px;margin-bottom:20px}.group-title[data-v-77627575]{font-size:14px;color:#333;margin-bottom:15px}.img-list[data-v-77627575]{display:flex;flex-wrap:wrap;gap:10px}.img-item[data-v-77627575]{width:80px;height:80px;position:relative}.img-item uni-image[data-v-77627575]{width:100%;height:100%;border-radius:4px}.del-btn[data-v-77627575]{position:absolute;top:-5px;right:-5px;width:18px;height:18px;background:rgba(0,0,0,.5);color:#fff;border-radius:50%;text-align:center;line-height:16px;font-size:12px}.upload-btn[data-v-77627575]{width:80px;height:80px;border:1px dashed #ddd;border-radius:4px;display:flex;align-items:center;justify-content:center;color:#999;font-size:24px}.submit-btn[data-v-77627575]{background:#07c160;color:#fff;text-align:center;height:44px;line-height:44px;border-radius:22px;font-size:16px;font-weight:700;margin-top:30px}",""]),e.exports=t},3471:function(e,t,n){"use strict";n("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,a.default)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(u)throw o}}}},n("01a2"),n("e39c"),n("bf0f"),n("844d"),n("18f7"),n("de6c"),n("7a76"),n("c9b5");var a=function(e){return e&&e.__esModule?e:{default:e}}(n("5d6b"))},"39be":function(e,t,n){"use strict";n.r(t);var a=n("514c"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t["default"]=i.a},"514c":function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("18f7"),n("de6c"),n("bf0f"),n("aa9c"),n("dd2b");var i=a(n("2634")),r=a(n("3471")),o=a(n("2fdc")),s={data:function(){return{order_sn:"",type:"1",reason:"",images:[]}},onLoad:function(e){e.order_sn?this.order_sn=e.order_sn:(uni.showToast({title:"参数错误",icon:"none"}),setTimeout((function(){return uni.navigateBack()}),1500))},methods:{onTypeChange:function(e){this.type=e.detail.value},chooseImage:function(){var e=this;uni.chooseImage({count:3-this.images.length,success:function(t){e.uploadImages(t.tempFilePaths)}})},uploadImages:function(e){var t=this;return(0,o.default)((0,i.default)().mark((function n(){var a,o,s,u;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=uni.getStorageSync("token"),a){n.next=3;break}return n.abrupt("return",uni.showToast({title:"请先登录",icon:"none"}));case 3:uni.showLoading({title:"上传中"}),o=(0,r.default)(e),n.prev=5,u=(0,i.default)().mark((function e(){var n,r,o;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=s.value,e.prev=1,e.next=4,new Promise((function(e,t){uni.uploadFile({url:"https://ref.tajian.cc/backend/api/upload.php",filePath:n,name:"file",header:{Authorization:"Bearer "+a},success:e,fail:t})}));case 4:r=e.sent,o=JSON.parse(r.data),200==o.code?t.images.push(o.url):uni.showToast({title:o.message||"上传失败",icon:"none"}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),uni.showToast({title:"上传出错",icon:"none"});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})),o.s();case 8:if((s=o.n()).done){n.next=12;break}return n.delegateYield(u(),"t0",10);case 10:n.next=8;break;case 12:n.next=17;break;case 14:n.prev=14,n.t1=n["catch"](5),o.e(n.t1);case 17:return n.prev=17,o.f(),n.finish(17);case 20:uni.hideLoading();case 21:case"end":return n.stop()}}),n,null,[[5,14,17,20]])})))()},delImage:function(e){this.images.splice(e,1)},previewImage:function(e){uni.previewImage({urls:[e]})},submit:function(){var e=this;return(0,o.default)((0,i.default)().mark((function t(){var n,a;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.reason){t.next=2;break}return t.abrupt("return",uni.showToast({title:"请填写原因",icon:"none"}));case 2:return uni.showLoading({title:"提交中"}),t.prev=3,n={order_sn:e.order_sn,type:e.type,reason:e.reason,images:e.images.join(",")},t.next=7,uni.$api("mall.php?action=apply_refund","POST",n);case 7:a=t.sent,uni.hideLoading(),200==a.code?(uni.showToast({title:"提交成功"}),setTimeout((function(){uni.navigateBack()}),1500)):uni.showToast({title:a.message||"提交失败",icon:"none"}),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](3),uni.hideLoading(),uni.showToast({title:"网络错误",icon:"none"});case 16:case"end":return t.stop()}}),t,null,[[3,12]])})))()}}};t.default=s},"529d":function(e,t,n){"use strict";n.r(t);var a=n("c227"),i=n("39be");for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);n("f57d");var o=n("828b"),s=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"77627575",null,!1,a["a"],void 0);t["default"]=s.exports},c227:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"container"},[n("v-uni-view",{staticClass:"form-group"},[n("v-uni-view",{staticClass:"form-item"},[n("v-uni-text",{staticClass:"label"},[e._v("订单编号")]),n("v-uni-text",{staticClass:"value"},[e._v(e._s(e.order_sn))])],1),n("v-uni-view",{staticClass:"form-item"},[n("v-uni-text",{staticClass:"label"},[e._v("售后类型")]),n("v-uni-radio-group",{staticClass:"radio-group",on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.onTypeChange.apply(void 0,arguments)}}},[n("v-uni-label",{staticClass:"radio"},[n("v-uni-radio",{attrs:{value:"1",checked:"true",color:"#07C160"}}),e._v("仅退款")],1),n("v-uni-label",{staticClass:"radio"},[n("v-uni-radio",{attrs:{value:"2",color:"#07C160"}}),e._v("退货退款")],1)],1)],1),n("v-uni-view",{staticClass:"form-item"},[n("v-uni-text",{staticClass:"label"},[e._v("申请原因")]),n("v-uni-input",{staticClass:"input",attrs:{placeholder:"请输入申请原因"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}})],1)],1),n("v-uni-view",{staticClass:"upload-group"},[n("v-uni-view",{staticClass:"group-title"},[e._v("凭证图片 (可选)")]),n("v-uni-view",{staticClass:"img-list"},[e._l(e.images,(function(t,a){return n("v-uni-view",{key:a,staticClass:"img-item"},[n("v-uni-image",{attrs:{src:t,mode:"aspectFill"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.previewImage(t)}}}),n("v-uni-view",{staticClass:"del-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.delImage(a)}}},[e._v("x")])],1)})),e.images.length<3?n("v-uni-view",{staticClass:"upload-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"iconfont icon-camera"},[e._v("+")])],1):e._e()],2)],1),n("v-uni-view",{staticClass:"submit-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("提交申请")])],1)},i=[]},f57d:function(e,t,n){"use strict";var a=n("ff6d"),i=n.n(a);i.a},ff6d:function(e,t,n){var a=n("1c27");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("967d").default;i("014055e9",a,!0,{sourceMap:!1,shadowMode:!1})}}]);